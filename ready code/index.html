<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Мониторинг безопасности</title>
</head>
<body>
    <h1>Система мониторинга безопасности</h1>
    
    <h2>Статус дверей:</h2>
    <div id="door-status"></div>

    <h2>Статус сигнализации:</h2>
    <div id="alarm-status"></div>

    <button onclick="updateDoor('room1', 'open')">Открыть дверь 1</button>
    <button onclick="updateDoor('room1', 'closed')">Закрыть дверь 1</button>
    
    <button onclick="updateAlarm('on')">Включить сигнализацию</button>
    <button onclick="updateAlarm('off')">Выключить сигнализацию</button>

    <script>
        async function fetchStatus() {
            const response = await fetch('/status');
            const data = await response.json();
            document.getElementById('door-status').innerText = JSON.stringify(data.doors);
            document.getElementById('alarm-status').innerText = data.alarm === 'on' ? 'Сигнализация включена' : 'Сигнализация выключена';
        }

        async function updateDoor(room, status) {
            await fetch(`/update_door/${room}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ status })
            });
            fetchStatus();
        }

        async function updateAlarm(status) {
            await fetch('/update_alarm', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ status })
            });
            fetchStatus();
        }

        // Обновление статуса при загрузке страницы
        fetchStatus();
    </script>
</body>
</html>